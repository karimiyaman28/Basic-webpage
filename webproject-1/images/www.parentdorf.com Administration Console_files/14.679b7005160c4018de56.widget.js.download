(window.webpackJsonpWidget=window.webpackJsonpWidget||[]).push([[14],{163:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(226),c=n(193),a=n(3),s=n.n(a),u=n(184),l=n(1),f=n(171),d=n(354),m=function(e){return!(!e||"function"!=typeof e.focus)},b=function(){return"undefined"==typeof document?[]:Array.prototype.slice.call(document.forms).reduce(function(e,t){return e.concat(Array.prototype.slice.call(t).filter(m))},[])},p=function(e,t){return e.find(function(e){return e.name&&Object(d.e)(t,e.name)})},h=function(){},y=function(e,t){return function(n){var r=function(n){e||(e=b),t||(t=p);var r=t(e(),n);r&&r.focus()},i=n.submit,o={},c=n.subscribe(function(e){o=e},{errors:!0,submitErrors:!0}),a=function(){var e=o,t=e.errors,n=e.submitErrors;t&&Object.keys(t).length?r(t):n&&Object.keys(n).length&&r(n)};return n.submit=function(){var e=i.call(n);return e&&"function"==typeof e.then?e.then(a,h):a(),e},function(){c(),n.submit=i}}},g=n(2),k=function(e){return!(!e||"function"!=typeof e.focus)},v=y(function(){return void 0===window.parent.document?[]:Array.prototype.slice.call(window.parent.document.getElementById("widget-frame").contentDocument.forms).reduce(function(e,t){return e.concat(Array.prototype.slice.call(t).filter(k))},[])},function(e,t){var n=Object.assign({},t,t.customFields);return e.find(function(e){return e.id!==g.p&&e.name&&Object(d.e)(n,e.name)})}),F=function(e){return{id:0,name:"name",labelForCustomers:e("ticketForm.nameLabel"),type:"custom_text",default:!0,requiredForCustomers:!1}},j=function(e){return[F(e),{id:1,name:"email",labelForCustomers:e("ticketForm.emailLabel"),type:"default_requester",default:!0,requiredForCustomers:!0},{id:2,name:"subject",labelForCustomers:e("ticketForm.subjectLabel"),type:"custom_text",default:!0,requiredForCustomers:!1},{id:3,name:"description",labelForCustomers:e("ticketForm.descriptionLabel"),type:"default_description",default:!0,requiredForCustomers:!0}]},O=n(18),w=n(71),T=n(73),E=n(314),C=n(313),S=n(91);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var x=function(e){var t=e.showDeck,n=e.validateAttachment,a=e.ticketFields,s=e.hiddenFields,u=e.disabledFields,f=e.settings,d=e.formProps,m=e.prefill,b=e.prefillRefreshId,p=e.isSubmitting,h=e.t,y=e.hiddenChoices,g=f.appearanceButtonColor,k=f.appearanceButtonTextColor,v=f.labelsContactFormSubmit,F=f.componentsContactFormCaptcha,j=f.componentsContactFormAttachFiles,w=f.componentsContactFormScreenshot,T=d.handleSubmit,C=d.pristine,_=d.invalid,P=d.form,A=b&&b.ticketForm||"",I=R(Object(O.b)(),2),D=(I[0].form,I[1]);return Object(r.useEffect)(function(){D({type:S.a,formName:"ticketForm",formState:!0})},[]),Object(r.useEffect)(function(){m&&m.ticketForm&&P.batch(function(){Object.keys(m.ticketForm).forEach(function(e){"customFields"===e?Object.keys(m.ticketForm.customFields).forEach(function(e){P.change("customFields.".concat(e),m.ticketForm.customFields[e])}):P.change(e,m.ticketForm[e])})})},[A]),i.a.createElement(c.e,{"data-testid":"form-element",showDeck:t,onSubmit:function(e){return n(e,P,T)}},i.a.createElement(E.a,{ticketFields:a,form:P,hiddenFields:s&&s.ticketForm||[],disabledFields:u&&u.ticketForm||[],hiddenChoices:y&&y.ticketForm||{}}),(j||w&&!Object(l.p)())&&i.a.createElement(o.b,{settings:f}),F&&i.a.createElement(o.c,null),i.a.createElement(c.c,null,i.a.createElement(o.a,{long:"true",dark:!(C||_),buttonColor:g,buttonTextColor:k,type:"submit",disabled:p,hideButtonText:p},v||h("common.submit"),p?i.a.createElement(c.b,null):null)))};x.propTypes={t:s.a.func,showDeck:s.a.bool,prefill:s.a.object,hiddenFields:s.a.object,disabledFields:s.a.object,settings:s.a.object,prefillRefreshId:s.a.object,validateAttachment:s.a.func,ticketFields:s.a.array,formProps:s.a.object,isSubmitting:s.a.bool,hiddenChoices:s.a.object},x.defaultProps={t:function(){},prefill:{},showDeck:!1,hiddenFields:{},disabledFields:{},settings:{},prefillRefreshId:{},validateAttachment:function(){},ticketFields:[],formProps:{},isSubmitting:!1,hiddenChoices:{}};var L=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=A(this,I(t).call(this)))._isMounted=!1,e.fetchTicketFields=function(){var t=e.props,n=t.settings,r=t.t,i=t.addToast,c=n.freshdeskDomain,a=n.widgetLanguage,s=e.state.isProductPresent;e._isMounted&&e.setState({isLoadingTicketFields:!0});var u="".concat(c,"/api/widget/ticket_fields?language=").concat(a);Object(l.f)(u,{method:"get"}).then(function(e){return e.json()}).then(function(t){if(t){if(t&&t.code)return void i({message:Object(l.e)(t,r)});var n=Object(o.e)(Object(l.c)(t,{deep:!0}),"ticketFieldId");if(n&&n.length){var c=n.filter(function(e){return"product_id"===e.name});s=c.length>0;var a=n.findIndex(function(e){return"email"===e.name});-1!==a&&n.splice(a,0,F(r))}e._isMounted&&e.setState({isLoadingTicketFields:!1,ticketFields:n,isProductPresent:s})}},function(){})},e.state={ticketFields:[],isLoadingTicketFields:!1,isProductPresent:!1},e}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this.props,t=e.settings,n=e.t,r=e.showForm,i=t.componentsContactFormType;return r.ticket?(2===i?this.fetchTicketFields():this.setState({ticketFields:j(n)}),!0):null}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.props,n=t.t,r=t.gotoThanks,o=t.card,a=t.showDeck,s=t.prefill,l=t.hiddenFields,f=t.disabledFields,d=t.settings,m=t.clearRefreshId,b=t.prefillRefreshId,p=t.hiddenChoices,h=d.freshdeskProductId,y=d.labelsContactFormTitle,g=d.componentsContactFormType;if(!o.show)return null;var k=this.state,F=k.ticketFields,j=k.isLoadingTicketFields,O={},w=F.find(function(e){return"default_priority"===e.type}),T=F.find(function(e){return"default_status"===e.type});h&&(O.product_id=h),w&&(O.priority=1),T&&(O.status=2);var E=2===g?"advanced-form":"simple-form";return i.a.createElement(c.m,{"data-testid":E},i.a.createElement(c.i,null),i.a.createElement(c.k,{"data-testid":"form-title"},y),j?i.a.createElement(c.d,null):i.a.createElement(C.a,{goThanks:r},function(t){var r=t.ticketCreate,o=t.validateAttachment,c=t.isSubmitting;return i.a.createElement("div",{"data-testid":"ticket-form-submit",key:m&&m.ticketForm},i.a.createElement(u.b,{initialValues:O,decorators:[v],keepDirtyOnReinitialize:!0,onSubmit:function(t,n){return r(t,n,e.props)},render:function(e){return i.a.createElement(x,{hiddenChoices:p,showDeck:a,validateAttachment:o,ticketFields:F,hiddenFields:l,disabledFields:f,clearRefreshId:m,settings:d,formProps:e,prefill:s,prefillRefreshId:b,isSubmitting:c,t:n})}}))}))}}])&&P(n.prototype,a),s&&P(n,s),t}();L.propTypes={t:s.a.func,gotoThanks:s.a.func,card:s.a.object,showDeck:s.a.bool,prefill:s.a.object,hiddenFields:s.a.object,disabledFields:s.a.object,settings:s.a.object,clearRefreshId:s.a.object,prefillRefreshId:s.a.object,showForm:s.a.object,hiddenChoices:s.a.object,addToast:s.a.func},L.defaultProps={t:function(){},prefill:{},gotoThanks:function(){},card:{},showDeck:!1,hiddenFields:{},disabledFields:{},settings:{},clearRefreshId:{},prefillRefreshId:{},showForm:{},hiddenChoices:{},addToast:function(){}};t.default=Object(f.b)()(Object(w.b)(T.a)(L))},313:function(e,t,n){"use strict";var r=n(0),i=n(3),o=n.n(i),c=n(171),a=n(71),s=n(73),u=n(1),l=n(18),f=n(4);function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){m(e,t,n[t])})}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var h=function(e){var t=e.children,n=p(Object(l.b)(),2),i=n[0].app,o=n[1],c=p(Object(r.useState)(!1),2),a=c[0],s=c[1],m=Object(r.useCallback)(function(t){var n=e.t,r=e.addToast;s(!1),r({message:Object(u.e)(t,n)})},[e.addToast]),h=Object(r.useCallback)(function(t,n){var r=e.goThanks;i.seenArticles.length&&Object(f.m)(o),t.reset(),s(!1),r(n.id)},[e.goThanks]);return t({ticketCreate:Object(r.useCallback)(function(e,t,n){s(!0);var r=n.settings,o=r.freshdeskDomain,c=r.metaDataVersion,a=[],l=[];t.getRegisteredFields().forEach(function(e){e.startsWith("customFields.")?l.push(e.split("customFields.")[1]):a.push(e)});var f=e.customFields,p=b(e,["customFields"]);(f&&Object.keys(f).forEach(function(e){l.includes(e)||delete f[e]}),Object.keys(p).forEach(function(e){a.includes(e)||delete p[e]}),e.frustrationTracking)&&(p.subject=e.subject,p[c?"frustrationTracking":"predictive"]=e.frustrationTracking,p.meta=e.meta);i.seenArticles.length&&(p.meta=d({},p.meta||{},{seen_articles:i.seenArticles}));var y=f&&Object.keys(f).length?Object(u.v)(d({},p,{customFields:f})):Object(u.v)(p);y&&y.g_recaptcha_response&&delete Object.assign(y,{"g-recaptcha-response":y.g_recaptcha_response}).g_recaptcha_response;var g="".concat(o,"/api/widget/tickets"),k={method:"POST",redirect:"follow",body:JSON.stringify(y)};Object(u.f)(g,k,!0,"ticket_create").then(function(e){return e.json()}).then(function(e){if(e){if(e.errors||e.code)return void m(e);h(t,e)}},function(e){m(e)})},[i.seenArticles]),validateAttachment:Object(r.useCallback)(function(t,n,r){var i=n.getState().errors,o=e.t,c=e.addToast;i&&i.attachment_ids&&i.attachment_ids.hasProgress?(t&&"function"==typeof t.preventDefault&&t.preventDefault(),c({message:o("common.fileAttachment.uploadProgress")})):r(t)},[e.addToast]),isSubmitting:a})};h.propTypes={goThanks:o.a.func,children:o.a.func,t:o.a.func,addToast:o.a.func},h.defaultProps={goThanks:function(){},children:function(){},t:function(){},addToast:function(){}},t.a=Object(c.b)()(Object(a.b)(s.a)(h))},314:function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(226);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}t.a=function(e){var t=e.ticketFields,n=e.form,r=e.hiddenFields,s=e.disabledFields,u=t,l=e.hiddenChoices||{},f=l.custom_fields,d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){c(e,t,n[t])})}return e}({},a(l,["custom_fields"]),f);return u.forEach(function(e){d[e.name]&&e.choices&&(e.choices=e.choices.filter(function(t){return!d[e.name].includes(t.value)})),"nested_field"===e.type&&e.nestedTicketFields&&e.nestedTicketFields.forEach(function(t){d[t.name]&&e.choices.forEach(function(e){e.choices&&(2===t.level&&(e.choices=e.choices.filter(function(e){return!d[t.name].includes(e.value)})),3===t.level&&e.choices.forEach(function(e){e.choices&&(e.choices=e.choices.filter(function(e){return!d[t.name].includes(e.value)}))}))})})}),u&&u.filter(function(e){return!e.belongsToSection}).map(function(e){return i.a.createElement(o.d,{key:e.id,ticketField:e,form:n,hiddenFields:r,disabledFields:s})})}}}]);